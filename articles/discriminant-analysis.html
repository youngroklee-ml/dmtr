<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>판별분석 • dmtr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="판별분석">
<meta property="og:description" content="dmtr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dmtr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discriminant-analysis.html">판별분석</a>
    </li>
    <li>
      <a href="../articles/logistic-regression.html">로지스틱 회귀분석</a>
    </li>
    <li>
      <a href="../articles/pca.html">주성분분석</a>
    </li>
    <li>
      <a href="../articles/plsr.html">부분최소자승 회귀분석</a>
    </li>
    <li>
      <a href="../articles/regression.html">회귀분석</a>
    </li>
    <li>
      <a href="../articles/tree.html">트리기반 기법</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="discriminant-analysis_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>판별분석</h1>
            
      
      
      <div class="hidden name"><code>discriminant-analysis.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dmtr</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></code></pre></div>
<div id="데이터" class="section level1" number="1">
<h1 class="hasAnchor">
<a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0" class="anchor"></a><span class="header-section-number">1</span> 데이터</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">binaryclass2</span>, package <span class="op">=</span> <span class="st">"dmtr"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:fisher-data-print">Table 1.1: </span>판별분석 학습표본 데이터</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="피셔-판별-함수" class="section level1" number="2">
<h1 class="hasAnchor">
<a href="#%ED%94%BC%EC%85%94-%ED%8C%90%EB%B3%84-%ED%95%A8%EC%88%98" class="anchor"></a><span class="header-section-number">2</span> 피셔 판별 함수</h1>
<p>각 객체는 변수벡터 <span class="math inline">\(\mathbf{x} \in \mathbb{R}^p\)</span>와 범주 <span class="math inline">\(y \in \{1, 2\}\)</span>로 이루어진다고 하자. 아래는 변수 <span class="math inline">\(\mathbf{x}\)</span>의 기대치와 분산-공분산행렬(varinace-covariance matrix)을 나타낸다.</p>
<p><span class="math display">\[\begin{eqnarray*}
\boldsymbol\mu_1 = E(\mathbf{x} | y = 1)\\
\boldsymbol\mu_2 = E(\mathbf{x} | y = 2)\\
\boldsymbol\Sigma = Var(\mathbf{x} | y = 1) = Var(\mathbf{x} | y = 2)
\end{eqnarray*}\]</span></p>
<p>다음과 같이 변수들의 선형조합으로 새로운 변수 <span class="math inline">\(z\)</span>를 형성하는 함수를 피셔 판별함수(Fisher’s discriminant function)라 한다.</p>
<p><span class="math display" id="eq:fisher-discriminant-function">\[\begin{equation}
z = \mathbf{w}^\top \mathbf{x} \tag{2.1}
\end{equation}\]</span></p>
<p>여기서 계수벡터 <span class="math inline">\(\mathbf{w} \in \mathbb{R}^p\)</span>는 통상 아래와 같이 변수 <span class="math inline">\(z\)</span>의 범주간 평균 차이 대 변수 <span class="math inline">\(z\)</span>의 분산의 비율을 최대화하는 것으로 결정한다.</p>
<p><span class="math display" id="eq:fisher-discriminant-function-coef">\[\begin{equation}
{\arg\!\min}_{\mathbf{w}} \frac{\mathbf{w}^\top ( \boldsymbol\mu_1 - \boldsymbol\mu_2 )}{\mathbf{w}^\top \boldsymbol\Sigma \mathbf{w}} \tag{2.2}
\end{equation}\]</span></p>
<p>위 식 <a href="#eq:fisher-discriminant-function-coef">(2.2)</a>의 해는</p>
<p><span class="math display">\[\begin{equation*}
\mathbf{w} \propto \boldsymbol\Sigma^{-1}(\boldsymbol\mu_1 - \boldsymbol\mu_2)
\end{equation*}\]</span></p>
<p>의 조건을 만족하며, 편의상 비례상수를 1로 두면 아래와 같은 해가 얻어진다.</p>
<p><span class="math display" id="eq:fisher-discriminant-function-coef-sol">\[\begin{equation}
\mathbf{w} = \boldsymbol\Sigma^{-1}(\boldsymbol\mu_1 - \boldsymbol\mu_2) \tag{2.3}
\end{equation}\]</span></p>
<p>실제 모집단의 평균 및 분산을 알지 못하는 경우, 학습표본으로부터 <span class="math inline">\(\boldsymbol\mu_1, \boldsymbol\mu_2, \boldsymbol\Sigma\)</span>의 추정치를 얻어 식 <a href="#eq:fisher-discriminant-function-coef-sol">(2.3)</a>에 대입하는 방식으로 판별계수를 추정한다. 자세한 내용은 교재 <span class="citation">(<a href="#ref-jun2012datamining" role="doc-biblioref">전치혁 2012</a>)</span> 참조.</p>
<p>Table <a href="#tab:fisher-data-print">1.1</a>에 주어진 학습표본을 이용하여 피셔 판별함수를 구해보도록 하자. 우선 각 범주별 관측수 <span class="math inline">\(n_1, n_2\)</span>, 평균벡터 <span class="math inline">\(\hat{\boldsymbol\mu}_1, \hat{\boldsymbol\mu}_2\)</span>, 그리고 범주별 표본 분산-공분산행렬 <span class="math inline">\(\mathbf{S}_1, \mathbf{S}_2\)</span>를 다음과 같이 함수 <code><a href="../reference/group_summary.html">group_summary()</a></code>를 사용하여 구한다.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">summary_within_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/group_summary.html">group_summary</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">summary_within_group</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [[1]]$n</span>
<span class="co">#&gt; [1] 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]]$mean</span>
<span class="co">#&gt; x1 x2 </span>
<span class="co">#&gt;  4  6 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[1]]$sigma</span>
<span class="co">#&gt;          x1        x2</span>
<span class="co">#&gt; x1 3.333333 1.0000000</span>
<span class="co">#&gt; x2 1.000000 0.6666667</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [[2]]$n</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]$mean</span>
<span class="co">#&gt;  x1  x2 </span>
<span class="co">#&gt; 6.6 5.4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]$sigma</span>
<span class="co">#&gt;      x1   x2</span>
<span class="co">#&gt; x1 4.30 2.95</span>
<span class="co">#&gt; x2 2.95 3.80</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"group")</span>
<span class="co">#&gt; [1] 1 2</span>
<span class="co">#&gt; Levels: 1 2</span></code></pre></div>
<p>위에서 얻은 결과를 이용하여 합동 분산-공분산행렬을 아래와 같이 추정한다.</p>
<p><span class="math display">\[\begin{equation*}
\hat{\boldsymbol\Sigma} = \mathbf{S}_p = \frac{(n_1 - 1)\mathbf{S}_1 + (n_2 - 1)\mathbf{S}_2}{n_1 + n_2 - 2}
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sigma_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pooled_variance.html">pooled_variance</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sigma_hat</span><span class="op">)</span>
<span class="co">#&gt;          x1       x2</span>
<span class="co">#&gt; x1 3.885714 2.114286</span>
<span class="co">#&gt; x2 2.114286 2.457143</span></code></pre></div>
<p>위에서 구한 추정치들을 이용하여 아래와 같이 판별함수 계수 추정치 <span class="math inline">\(\hat{\mathbf{w}}\)</span>를 구한다.
<span class="math display">\[\begin{equation*}
\hat{\mathbf{w}} = \hat{\boldsymbol\Sigma}^{-1}(\hat{\boldsymbol\mu}_1 - \hat{\boldsymbol\mu}_2) 
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mu_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">summary_within_group</span>, <span class="op">~</span> <span class="va">.</span><span class="op">[[</span><span class="st">"mean"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">w_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">sigma_hat</span><span class="op">)</span> <span class="op">%*%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">mu_hat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">mu_hat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">w_hat</span><span class="op">)</span>
<span class="co">#&gt; [1] -1.508039  1.541801</span></code></pre></div>
<p>위 피셔 판별함수를 구하는 과정을 하나의 함수 <code><a href="../reference/fisher_ld.html">fisher_ld()</a></code>로 구현하였다.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fisher_ld.html">fisher_ld</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">w_hat</span><span class="op">)</span>
<span class="co">#&gt;        x1        x2 </span>
<span class="co">#&gt; -1.508039  1.541801 </span>
<span class="co">#&gt; attr(,"group")</span>
<span class="co">#&gt; [1] 1 2</span>
<span class="co">#&gt; Levels: 1 2</span></code></pre></div>
<div id="분류-규칙" class="section level2" number="2.1">
<h2 class="hasAnchor">
<a href="#%EB%B6%84%EB%A5%98-%EA%B7%9C%EC%B9%99" class="anchor"></a><span class="header-section-number">2.1</span> 분류 규칙</h2>
<p>피셔 판별함수에 따른 분류 경계값은 학습표본에 대한 판별함수값의 평균으로 아래와 같이 구할 수 있다.</p>
<p><span class="math display">\[\begin{equation*}
\bar{z} = \frac{1}{N} \sum_i^N \hat{\mathbf{w}}^\top \mathbf{x}_i
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z_mean</span> <span class="op">&lt;-</span> <span class="va">binaryclass2</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">`*`</span><span class="op">(</span><span class="va">w_hat</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">z_mean</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.526438</span></code></pre></div>
<p>위 분류 경계값을 구하는 과정을 함수 <code><a href="../reference/fisher_ld_threshold.html">fisher_ld_threshold()</a></code>로 구현하였다.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fisher_ld_threshold.html">fisher_ld_threshold</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">z_mean</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.526438</span></code></pre></div>
<p>위 결과를 통해, 분류규칙은 다음과 같이 주어진다.</p>
<ul>
<li>
<span class="math inline">\(\hat{\mathbf{w}}^\top \mathbf{x} \ge \bar{z}\)</span> 이면, <span class="math inline">\(\mathbf{x}\)</span>를 범주 1로 분류</li>
<li>
<span class="math inline">\(\hat{\mathbf{w}}^\top \mathbf{x} &lt; \bar{z}\)</span> 이면, <span class="math inline">\(\mathbf{x}\)</span>를 범주 2로 분류</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">class_level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">summary_within_group</span>, <span class="st">"group"</span><span class="op">)</span>

<span class="va">prediction_df</span> <span class="op">&lt;-</span> <span class="va">binaryclass2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    z <span class="op">=</span> <span class="va">w_hat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">w_hat</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span>,
    .pred_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">z</span> <span class="op">&gt;=</span> <span class="va">z_mean</span>, <span class="va">class_level</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">class_level</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, 
      levels <span class="op">=</span> <span class="va">class_level</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>위 분류 과정을 함수 <code><a href="../reference/fisher_ld_prediction.html">fisher_ld_prediction()</a></code>을 이용하여 아래와 같이 수행할 수 있다.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fisher_ld_prediction.html">fisher_ld_prediction</a></span><span class="op">(</span>
  .w <span class="op">=</span> <span class="va">w_hat</span>, 
  .z <span class="op">=</span> <span class="va">z_mean</span>, 
  .newdata <span class="op">=</span> <span class="va">binaryclass2</span>, 
  .xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>,
  .levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">w_hat</span>, <span class="st">"group"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>분류 결과는 아래와 같다.</p>
<table class="table">
<caption>
<span id="tab:fisher-da-result">Table 2.1: </span>학습표본에 대한 피셔 분류 결과</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">class</th>
<th align="right">z</th>
<th align="right">.pred_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">3.2524116</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">-1.4067524</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">1.7781350</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">-2.8135048</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">4.7266881</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">4.6929260</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.2025723</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">-4.3215434</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-1.3729904</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>위 결과 객체 3, 7가 오분류된다.</p>
</div>
</div>
<div id="의사결정론에-의한-분류규칙" class="section level1" number="3">
<h1 class="hasAnchor">
<a href="#%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%EB%A1%A0%EC%97%90-%EC%9D%98%ED%95%9C-%EB%B6%84%EB%A5%98%EA%B7%9C%EC%B9%99" class="anchor"></a><span class="header-section-number">3</span> 의사결정론에 의한 분류규칙</h1>
<p>다음과 같이 객체가 각 범주에 속할 사전확률과 각 범주 내에서의 분류변수의 확률밀도함수에 대한 기호를 정의한다.</p>
<ul>
<li>
<span class="math inline">\(\pi_k\)</span>: 임의의 객체가 범주 <span class="math inline">\(k\)</span>에 속할 사전확률</li>
<li>
<span class="math inline">\(f_k(\mathbf{x})\)</span>: 범주 <span class="math inline">\(k\)</span>에 대한 변수의 확률밀도함수</li>
</ul>
<p>이 때 통상적으로 <span class="math inline">\(\mathbf{x}\)</span>는 다변량 정규분포를 따르는 것으로 가정하여 아래와 같이 평균벡터 <span class="math inline">\(\boldsymbol\mu_k\)</span>와 분산-공분산행렬 <span class="math inline">\(\boldsymbol\Sigma\)</span>로 확률밀도함수를 정의할 수 있다. 이 때 분산-공분산행렬 <span class="math inline">\(\boldsymbol\Sigma\)</span>는 모든 범주에 대해 동일하다고 가정한다.</p>
<p><span class="math display" id="eq:mv-gaussian-dist">\[\begin{equation}
f_k(\mathbf{x}) = \frac{1}{(2\pi)^{p/2}|\boldsymbol\Sigma|^{1/2}} \exp \{ -\frac{1}{2} \left(\mathbf{x} - \boldsymbol\mu_k\right)^\top \boldsymbol\Sigma^{-1} \left(\mathbf{x} - \boldsymbol\mu_k\right) \}
\tag{3.1}
\end{equation}\]</span></p>
<p>각 범주에 대한 판별함수를</p>
<p><span class="math display" id="eq:lda-discriminant-function">\[\begin{equation}
u_k(\mathbf{x}) = \boldsymbol\mu_k^\top \boldsymbol\Sigma^{-1}\mathbf{x} - \frac{1}{2} \boldsymbol\mu_k^\top \boldsymbol\Sigma^{-1} \boldsymbol\mu_k + \ln \pi_k
\tag{3.2}
\end{equation}\]</span></p>
<p>로 정의한다. 위 판별함수를 함수 <code><a href="../reference/ld_fun.html">ld_fun()</a></code>로 구현하였다.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ld_fun.html">ld_fun</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>위 함수를 이용하여 학습표본에 대해 판별함수값을 다음과 같이 얻을 수 있다.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">u_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dfc</a></span><span class="op">(</span><span class="va">f</span>, 
  <span class="op">~</span> <span class="va">binaryclass2</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">1</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; New names:</span>
<span class="co">#&gt; * u -&gt; u...1</span>
<span class="co">#&gt; * u -&gt; u...2</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">u_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">".score"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">f</span>, <span class="st">"group"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>
<span class="va">score_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">u_df</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:ld-fun-score">Table 3.1: </span>학습표본에 대한 LDA 적용 결과: 판별함수값</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">class</th>
<th align="right">.score_1</th>
<th align="right">.score_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">9.21</td>
<td align="right">6.97</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">-1.94</td>
<td align="right">0.49</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">11.01</td>
<td align="right">10.25</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">4.59</td>
<td align="right">8.42</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">7.40</td>
<td align="right">3.70</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">5.04</td>
<td align="right">1.37</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">5.72</td>
<td align="right">6.53</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">4.03</td>
<td align="right">9.37</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.43</td>
<td align="right">2.82</td>
</tr>
</tbody>
</table>
<p>베이즈 정리(Bayes’s theorem)에 따라 변수 <span class="math inline">\(\mathbf{x}\)</span>값이 주어졌을 때 범주 <span class="math inline">\(k\)</span>에 속할 사후확률(posterior)은 아래와 같이 구할 수 있다.</p>
<p><span class="math display" id="eq:lda-posterior">\[\begin{equation}
P(y = k \, | \, \mathbf{x}) = \frac{\pi_k f_k(\mathbf{x})}{f(\mathbf{x})}
\tag{3.3}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_df</span> <span class="op">&lt;-</span> <span class="va">u_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">exp</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">p_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">".pred"</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">f</span>, <span class="st">"group"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>
<span class="va">posterior_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">p_df</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:ld-posterior">Table 3.2: </span>학습표본에 대한 LDA 적용 결과: 사후확률값</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">class</th>
<th align="right">.pred_1</th>
<th align="right">.pred_2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.90</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">0.08</td>
<td align="right">0.92</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">0.68</td>
<td align="right">0.32</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">0.02</td>
<td align="right">0.98</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.98</td>
<td align="right">0.02</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.98</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.31</td>
<td align="right">0.69</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.08</td>
<td align="right">0.92</td>
</tr>
</tbody>
</table>
<p>최종적으로, 각 범주에 대한 사후확률이 높은 쪽으로 범주를 추정한다.</p>
<p><span class="math display" id="eq:lda-posterior-rule">\[\begin{equation}
\hat{y} = \begin{cases}
    1, &amp; \text{if } P(y = 1 \, | \, \mathbf{x}) \ge P(y = 2 \, | \, \mathbf{x})\\
    2, &amp; \text{otherwise}
\end{cases}
\tag{3.4}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yhat_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
  .pred_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">f</span>, <span class="st">"group"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">p_df</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span><span class="op">]</span>
<span class="op">)</span>

<span class="va">prediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">posterior_df</span>, <span class="va">yhat_df</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:ld-prediction">Table 3.3: </span>학습표본에 대한 LDA 적용 결과: 사후확률값 및 추정범주</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">class</th>
<th align="right">.pred_1</th>
<th align="right">.pred_2</th>
<th align="right">.pred_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.90</td>
<td align="right">0.10</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">0.08</td>
<td align="right">0.92</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">0.68</td>
<td align="right">0.32</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">0.02</td>
<td align="right">0.98</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.98</td>
<td align="right">0.02</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.98</td>
<td align="right">0.02</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0.31</td>
<td align="right">0.69</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.08</td>
<td align="right">0.92</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>위와 같이 새 데이터에 대해 판별함수값, 사후확률 및 범주추정을 수행하는 함수를 <code><a href="../reference/predict_da.html">predict_da()</a></code>로 구현하였다.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/predict_da.html">predict_da</a></span><span class="op">(</span><span class="va">f</span>, .new_data <span class="op">=</span> <span class="va">binaryclass2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, 
  .include_score <span class="op">=</span> <span class="cn">TRUE</span>,
  .include_posterior <span class="op">=</span> <span class="cn">TRUE</span>,
  .include_class <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 × 5</span>
<span class="co">#&gt;   .score_1 .score_2 .pred_1 .pred_2 .pred_class</span>
<span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;      </span>
<span class="co">#&gt; 1    9.21     6.97  0.903    0.0968 1          </span>
<span class="co">#&gt; 2   -1.94     0.489 0.0812   0.919  2          </span>
<span class="co">#&gt; 3   11.0     10.2   0.681    0.319  1          </span>
<span class="co">#&gt; 4    4.59     8.42  0.0212   0.979  2          </span>
<span class="co">#&gt; 5    7.40     3.70  0.976    0.0239 1          </span>
<span class="co">#&gt; 6    5.04     1.37  0.975    0.0247 1          </span>
<span class="co">#&gt; 7    5.72     6.53  0.307    0.693  2          </span>
<span class="co">#&gt; 8    4.03     9.37  0.00477  0.995  2          </span>
<span class="co">#&gt; 9    0.427    2.82  0.0838   0.916  2</span></code></pre></div>
</div>
<div id="이차-판별함수" class="section level1" number="4">
<h1 class="hasAnchor">
<a href="#%EC%9D%B4%EC%B0%A8-%ED%8C%90%EB%B3%84%ED%95%A8%EC%88%98" class="anchor"></a><span class="header-section-number">4</span> 이차 판별함수</h1>
<p>각 범주의 확률밀도함수는 아래와 같이 다변량 정규분포로 정의된다.</p>
<p><span class="math display" id="eq:qda-mv-gaussian-dist">\[\begin{equation}
f_k(\mathbf{x}) = \frac{1}{(2\pi)^{p/2}|\boldsymbol\Sigma_k|^{1/2}} \exp \{ -\frac{1}{2} \left(\mathbf{x} - \boldsymbol\mu_k\right)^\top \boldsymbol\Sigma_k^{-1} \left(\mathbf{x} - \boldsymbol\mu_k\right) \}
\tag{4.1}
\end{equation}\]</span></p>
<p>위 식 <a href="#eq:qda-mv-gaussian-dist">(4.1)</a>이 선형판별함수에서 사용한 식 <a href="#eq:mv-gaussian-dist">(3.1)</a>과 다른 부분은 분산-공분산분포 <span class="math inline">\(\boldsymbol\Sigma_k\)</span>가 범주 <span class="math inline">\(k\)</span>에 대해 각각 정의된다는 점이다.</p>
<p>이 경우 각 범주에 대한 판별함수는 아래와 같이 정의된다.</p>
<p><span class="math display" id="eq:qda-discriminant-function">\[\begin{equation}
u_k(\mathbf{x}) = - \frac{1}{2} (\mathbf{x} - \boldsymbol\mu_k)^\top \boldsymbol\Sigma_k^{-1} (\mathbf{x} - \boldsymbol\mu_k) - \frac{1}{2} \ln \left| \boldsymbol\Sigma_k \right| + \ln \pi_k
\tag{4.2}
\end{equation}\]</span></p>
<p>위 판별함수를 데이터로부터 얻는 함수를 <code><a href="../reference/qd_fun.html">qd_fun()</a></code>로 구현하였다.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qd_fun.html">qd_fun</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>이후, 선형판별함수에서와 같이 함수 <code>predict_df()</code>를 이용하여 판별함수값, 사후확률 및 범주추정값을 얻을 수 있다.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_da.html">predict_da</a></span><span class="op">(</span><span class="va">f</span>, .new_data <span class="op">=</span> <span class="va">binaryclass2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, 
  .include_score <span class="op">=</span> <span class="cn">TRUE</span>,
  .include_posterior <span class="op">=</span> <span class="cn">TRUE</span>,
  .include_class <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">prediction_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">binaryclass2</span>, <span class="va">prediction_df</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:qd-prediction">Table 4.1: </span>학습표본에 대한 QDA 적용 결과: 판별함수값, 사후확률 및 추정범주</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">class</th>
<th align="right">.score_1</th>
<th align="right">.score_2</th>
<th align="right">.pred_1</th>
<th align="right">.pred_2</th>
<th align="right">.pred_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">-1.73</td>
<td align="right">-3.95</td>
<td align="right">0.90</td>
<td align="right">0.10</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">-13.18</td>
<td align="right">-2.50</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">-3.91</td>
<td align="right">-3.15</td>
<td align="right">0.32</td>
<td align="right">0.68</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">-5.27</td>
<td align="right">-1.87</td>
<td align="right">0.03</td>
<td align="right">0.97</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">-1.18</td>
<td align="right">-5.76</td>
<td align="right">0.99</td>
<td align="right">0.01</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">-1.73</td>
<td align="right">-6.20</td>
<td align="right">0.99</td>
<td align="right">0.01</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">-2.00</td>
<td align="right">-1.93</td>
<td align="right">0.48</td>
<td align="right">0.52</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">-7.73</td>
<td align="right">-2.58</td>
<td align="right">0.01</td>
<td align="right">0.99</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-8.27</td>
<td align="right">-1.93</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="세-범주-이상의-분류" class="section level1" number="5">
<h1 class="hasAnchor">
<a href="#%EC%84%B8-%EB%B2%94%EC%A3%BC-%EC%9D%B4%EC%83%81%EC%9D%98-%EB%B6%84%EB%A5%98" class="anchor"></a><span class="header-section-number">5</span> 세 범주 이상의 분류</h1>
<div id="데이터-1" class="section level2" number="5.1">
<h2 class="hasAnchor">
<a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-1" class="anchor"></a><span class="header-section-number">5.1</span> 데이터</h2>
<p>3개의 범주를 지닌 붓꽃(iris) 데이터에 대해 판별분석을 수행하고자 한다.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris90</span>, package <span class="op">=</span> <span class="st">"dmtr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="선형-판별-분석" class="section level2" number="5.2">
<h2 class="hasAnchor">
<a href="#%EC%84%A0%ED%98%95-%ED%8C%90%EB%B3%84-%EB%B6%84%EC%84%9D" class="anchor"></a><span class="header-section-number">5.2</span> 선형 판별 분석</h2>
<p>함수 <code><a href="../reference/ld_fun.html">ld_fun()</a></code>을 이용하여 선형 판별함수를 구하고, <code><a href="../reference/predict_da.html">predict_da()</a></code>를 이용하여 판별함수 값을 구하고 범주를 추정한다.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ld_fun.html">ld_fun</a></span><span class="op">(</span><span class="va">iris90</span>, <span class="va">class</span>, <span class="va">x1</span><span class="op">:</span><span class="va">x4</span><span class="op">)</span>

<span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">x1</span>, <span class="op">~</span><span class="va">x2</span>, <span class="op">~</span><span class="va">x3</span>, <span class="op">~</span><span class="va">x4</span>, <span class="op">~</span><span class="va">class</span>,
  <span class="fl">5.1</span>, <span class="fl">3.5</span>, <span class="fl">1.4</span>, <span class="fl">0.2</span>, <span class="st">"setosa"</span>,
  <span class="fl">7.0</span>, <span class="fl">3.2</span>, <span class="fl">4.7</span>, <span class="fl">1.4</span>, <span class="st">"versicolor"</span>,
  <span class="fl">6.3</span>, <span class="fl">3.3</span>, <span class="fl">6.0</span>, <span class="fl">2.5</span>, <span class="st">"virginica"</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">class</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">predict_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_da.html">predict_da</a></span><span class="op">(</span><span class="va">f</span>, .new_data <span class="op">=</span> <span class="va">new_data</span>, .xvar <span class="op">=</span> <span class="va">x1</span><span class="op">:</span><span class="va">x4</span>, 
  .include_score <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">predict_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span><span class="va">new_data</span>, <span class="va">predict_df</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>
<span id="tab:ld-iris-prediction">Table 5.1: </span>붗꽃 표본에 대한 LDA 적용 결과: 판별함수값 및 추정범주</caption>
<thead><tr class="header">
<th align="right">x1</th>
<th align="right">x2</th>
<th align="right">x3</th>
<th align="right">x4</th>
<th align="right">class</th>
<th align="right">.score_setosa</th>
<th align="right">.score_versicolor</th>
<th align="right">.score_virginica</th>
<th align="right">.pred_class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="right">setosa</td>
<td align="right">69.14</td>
<td align="right">21.16</td>
<td align="right">-23.36</td>
<td align="right">setosa</td>
</tr>
<tr class="even">
<td align="right">7.0</td>
<td align="right">3.2</td>
<td align="right">4.7</td>
<td align="right">1.4</td>
<td align="right">versicolor</td>
<td align="right">28.09</td>
<td align="right">68.82</td>
<td align="right">60.17</td>
<td align="right">versicolor</td>
</tr>
<tr class="odd">
<td align="right">6.3</td>
<td align="right">3.3</td>
<td align="right">6.0</td>
<td align="right">2.5</td>
<td align="right">virginica</td>
<td align="right">-2.22</td>
<td align="right">90.70</td>
<td align="right">107.00</td>
<td align="right">virginica</td>
</tr>
</tbody>
</table>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-jun2012datamining" class="csl-entry">
전치혁. 2012. <em>데이터마이닝 기법과 응용</em>. 한나래출판사.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Youngrok Lee.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
